<!doctype html><html class="scroll-pt-16 scroll-smooth" lang=zh><head><meta name=generator content="Hugo 0.110.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=/css/style.css><script type=text/javascript src=/js/main.js></script><title>IO01 Blog</title></head><body><header class="sticky top-0 z-10 bg-white backdrop-filter backdrop-blur-lg bg-opacity-70 border-b border-gray-200"><nav class="max-w-5xl mx-auto px-4"><div class="flex items-center justify-between h-16"><a href=/ class="text-2xl text-gray-900 font-semibold">IO01 Blog</a><ul class="flex space-x-4 text-gray-900"><li><a href=/posts>归档</a></li><li><a href=/about>关于</a></li></ul></div></nav></header><div id=content><main class="flex flex-col justify-center"><div class="flex flex-col mx-auto w-5/6 lg:w-3/4 xl:w-3/5 my-4"><h2 class="text-2xl font-semibold hover:underline hover:underline-offset-4 hover:decoration-2"><a href=/posts/33dn/>MD5 计算前导 0 丢失问题</a></h2><div class="inline-flex my-1"><div class="inline-flex items-center"><svg viewBox="0 0 1 1" class="h-4 mr-1"><use href="#calendar"/></svg><span class=text-gray-500>2020-01-20</span></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#tags"/></svg><a href=/tags/java/ class="text-gray-500 mr-1">Java</a></div></div><div class="summary-item prose max-w-none"><h2 id=现象>现象</h2><p>我们使用 Java 生成 MD5 时常用的写法如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>static</span> String <span style=color:#50fa7b>md5</span><span style=color:#ff79c6>(</span>String data<span style=color:#ff79c6>)</span> <span style=color:#8be9fd;font-style:italic>throws</span> NoSuchAlgorithmException <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    MessageDigest md <span style=color:#ff79c6>=</span> MessageDigest<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getInstance</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;MD5&#34;</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    md<span style=color:#ff79c6>.</span><span style=color:#50fa7b>update</span><span style=color:#ff79c6>(</span>data<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>());</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>new</span> BigInteger<span style=color:#ff79c6>(</span><span style=color:#bd93f9>1</span><span style=color:#ff79c6>,</span> md<span style=color:#ff79c6>.</span><span style=color:#50fa7b>digest</span><span style=color:#ff79c6>()).</span><span style=color:#50fa7b>toString</span><span style=color:#ff79c6>(</span><span style=color:#bd93f9>16</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>如果计算 <code>a</code> 的 MD5 会发现结果为 <code>cc175b9c0f1b6a831c399e269772661</code>，只有 31 位，正确的值应该是 <code>0cc175b9c0f1b6a831c399e269772661</code>，仔细观察可以发现我们的计算方法把第一位 <code>0</code> 丢失了。</p></div><div class="bg-gray-200 w-full h-px mt-3"></div></div><div class="flex flex-col mx-auto w-5/6 lg:w-3/4 xl:w-3/5 my-4"><h2 class="text-2xl font-semibold hover:underline hover:underline-offset-4 hover:decoration-2"><a href=/posts/57fb/>从阿里规约谈起 - 包装类的值比较注意事项</a></h2><div class="inline-flex my-1"><div class="inline-flex items-center"><svg viewBox="0 0 1 1" class="h-4 mr-1"><use href="#calendar"/></svg><span class=text-gray-500>2019-11-29</span></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#series"/></svg><a href=/series/%E9%98%BF%E9%87%8C%E8%A7%84%E7%BA%A6/ class=text-gray-500>阿里规约</a></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#tags"/></svg><a href=/tags/java/ class="text-gray-500 mr-1">Java</a></div></div><div class="summary-item prose max-w-none"><h2 id=前言>前言</h2><p><code>int</code>、<code>long</code> 等基本数据类型值比较可以直接使用 <code>==</code> 比较，其包装类型：<code>Integer</code>、<code>Long</code> 如果直接使用 <code>==</code> 比较大小我们会发现一个神奇的现象。当然，阿里规约也对此做出强制规定：</p><blockquote><p><strong>【强制】</strong> 所有的相同类型的包装类对象之间值的比较，全部使用 <code>equals</code> 方法比较。</p></blockquote></div><div class="bg-gray-200 w-full h-px mt-3"></div></div><div class="flex flex-col mx-auto w-5/6 lg:w-3/4 xl:w-3/5 my-4"><h2 class="text-2xl font-semibold hover:underline hover:underline-offset-4 hover:decoration-2"><a href=/posts/27fg/>有趣的算法 - 布隆过滤器</a></h2><div class="inline-flex my-1"><div class="inline-flex items-center"><svg viewBox="0 0 1 1" class="h-4 mr-1"><use href="#calendar"/></svg><span class=text-gray-500>2019-10-30</span></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#tags"/></svg><a href=/tags/%E6%9D%82%E9%A1%B9/ class="text-gray-500 mr-1">杂项</a></div></div><div class="summary-item prose max-w-none"><h2 id=引言>引言</h2><p>现在假设一个需求：设计一个 url 黑名单系统，需求是 1 亿个 url 黑名单，每个 url 平均长度 30 字节，判断当前的 url 是否在黑名单中。</p><p>我们最先想到的可能时 HashSet，如果少量的 url，HashSet 有着 O(1) 的查询效率是首选的方案。但是面对 1 亿个 url，单单存储 value 就需要 2861MB 内存，显然不可取。而如果放到硬盘上进行数据库查询，面对近 3GB 的数据库，每次匹配都要查询的话，IO 操作本身就是瓶颈。</p><p>所以这时候引入了布隆过滤器。</p></div><div class="bg-gray-200 w-full h-px mt-3"></div></div><div class="flex flex-col mx-auto w-5/6 lg:w-3/4 xl:w-3/5 my-4"><h2 class="text-2xl font-semibold hover:underline hover:underline-offset-4 hover:decoration-2"><a href=/posts/23af/>从阿里规约谈起 - Arrays.asList 三坑</a></h2><div class="inline-flex my-1"><div class="inline-flex items-center"><svg viewBox="0 0 1 1" class="h-4 mr-1"><use href="#calendar"/></svg><span class=text-gray-500>2019-09-24</span></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#series"/></svg><a href=/series/%E9%98%BF%E9%87%8C%E8%A7%84%E7%BA%A6/ class=text-gray-500>阿里规约</a></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#tags"/></svg><a href=/tags/java/ class="text-gray-500 mr-1">Java</a></div></div><div class="summary-item prose max-w-none"><h2 id=前言>前言</h2><p>将数组转换成 List 是日常开发十分常见的操作，对此 JDK 提供了一个非常好用的工具类：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>List list <span style=color:#ff79c6>=</span> Arrays<span style=color:#ff79c6>.</span><span style=color:#50fa7b>asList</span><span style=color:#ff79c6>(</span>array<span style=color:#ff79c6>);</span>
</span></span></code></pre></div><p>但是如果操纵 List 的内容的话，阿里规约会给出一个提示：</p><p><img alt="使用 asList 的问题" title src=https://static.fori.fun/blog/posts/static/p3c_aslist_error.png></p><p>于是深入看了下，发现 <code>Arrays.asList</code> 有三个日常开发中容易坑人的地方。</p></div><div class="bg-gray-200 w-full h-px mt-3"></div></div><div class="flex flex-col mx-auto w-5/6 lg:w-3/4 xl:w-3/5 my-4"><h2 class="text-2xl font-semibold hover:underline hover:underline-offset-4 hover:decoration-2"><a href=/posts/6tf9/>从阿里规约谈起 - HashMap 初始化和扩容相关</a></h2><div class="inline-flex my-1"><div class="inline-flex items-center"><svg viewBox="0 0 1 1" class="h-4 mr-1"><use href="#calendar"/></svg><span class=text-gray-500>2019-08-30</span></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#series"/></svg><a href=/series/%E9%98%BF%E9%87%8C%E8%A7%84%E7%BA%A6/ class=text-gray-500>阿里规约</a></div><div class="inline-flex items-center ml-2"><svg viewBox="0 0 1 1" class="h-4 mx-1"><use href="#tags"/></svg><a href=/tags/java/ class="text-gray-500 mr-1">Java</a></div></div><div class="summary-item prose max-w-none"><h2 id=引言>引言</h2><p>日常开发中使用 HashMap 方法如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>Map<span style=color:#ff79c6>&lt;</span>String<span style=color:#ff79c6>,</span> Object<span style=color:#ff79c6>&gt;</span> HashMap <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> HashMap<span style=color:#ff79c6>&lt;&gt;();</span>
</span></span></code></pre></div><p>但是阿里规约会提示有问题：</p><p><img alt=未指定初始化容量 title src=https://static.fori.fun/blog/posts/static/p3c_hashmap_error.png></p><p>由此我们可以看一下 HashMap 初始化和扩容相关。</p><p>注：本文涉及了少许 HashMap 基础，由于与主线无关，不详讲。源码均加了些注释，注释无法解释清楚的地方放在源码之后论述。</p></div><div class="bg-gray-200 w-full h-px mt-3"></div></div><div class="my-2 flex w-screen justify-center"><a href=/ class="mx-3 sm:mx-4 font-semibold text-gray-400 hover:text-sky-400 hover:underline hover:underline-offset-4 hover:decoration-2">1</a>
<span class="mx-3 sm:mx-4 font-semibold text-sky-400 underline underline-offset-4 decoration-2">2</span>
<a href=/page/3/ class="mx-3 sm:mx-4 font-semibold text-gray-400 hover:text-sky-400 hover:underline hover:underline-offset-4 hover:decoration-2">3</a></div></main></div><footer><div class="flex justify-center mt-6 mb-2 text-gray-500"><span>&copy;2023
<span class=ml-2><a class=hover:text-sky-400 href=https://blog.io01.xyz>IO01</a></span></span>
<span class=mx-2>|</span>
<span>Powered by
<a class=hover:text-sky-400 href=https://gohugo.io>Hugo</a></span>
<span class=mx-1>&</span>
<span><a class=hover:text-sky-400 href=#>FullMoon</a></span></div></footer></body></html>